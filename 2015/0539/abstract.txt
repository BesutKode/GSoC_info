The way multiple personalities of architectures (e.g. x86-64/x32/x86) are supported now is inherently unreliable. Parsers should be compiled for each supported personality.