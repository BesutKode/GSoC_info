My proposal for this project, based on Linux Netfilter.