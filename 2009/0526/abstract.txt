A large amount of research into security protocols to find the best to establish that a pre-shared key is known by both communicating endpoints, and research into different encryption techniques to ensure data integrity.  Writing the XIO driver in C so that it accepts or rejects a connection based on the key.  Writing an additional protocol which checks that both sides have the same pre-shared key once the connection has been made.